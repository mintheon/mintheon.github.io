---
layout: post
title: "[대규모 시스템 설계 기초] 02. 개략적인 규모 추정"
subtitle: 'book'
date: 2023-10-11 20:20:30
categories: devlog
tags: book study
---

# 02. 개략적인 규모 추정

서비스의 설계가 요구사항에 부합하는지 보기 위한 것. 규모 확장성을 표현하는 데 필요한 기본기에 능숙해야한다.

기본기를 배우자.

---

## 2의 제곱수

데이터 볼륨의 단위를 2의 제곱수로 표현할 수 있어야 한다.

![image-20231018033708547](https://swagger.synology.me:5543/uploads/2023/10/image-20231018033708547.png)

---

## 응답 지연 값

![image-20231018033753784](https://swagger.synology.me:5543/uploads/2023/10/image-20231018033753784.png)

![image-20231018033806585](https://swagger.synology.me:5543/uploads/2023/10/image-20231018033806585.png)

### 결론

- 메모리는 빠르지만 디스크는 아직도 느리다.
- 디스크 탐색(seek)은 가능한 피하라.
- 단순한 압축 알고리즘은 빠르다.

---

## 가용성에 관계된 수치들

### 고가용성

시스템이 오랜시간 지속적으로 중단 없이 운영될 수 있는 능력. 퍼센트로 표현하며 100%는 단 한번의 중단도 없었다는 표현이다. 대부분 99~100 사이의 값을 갖는다.



### SLA(Service Level Agreement)

서비스 사업자와 고객 사이에 맺어진 합의를 의미. 서비스 사업자가 제공하는 서비스의 가용시간(uptime)이 공식적으로 기술되어 있음. (Azure, aws 등)



가용시간은 관습적으로 숫자 9를 사용해 표시한다. 9가 많을수록 좋다.

![image-20231018040215665](https://swagger.synology.me:5543/uploads/2023/10/image-20231018040215665.png)

---

### 예제

**[가정]**

- MAU는 3억명이다.
- 50%의 사용자가 트위터를 매일 사용한다.
- 평균적으로 각 사용자는 매일 2건의 트윗을 올린다.
- 미디어를 포함하는 트윗은 10% 정도다.
- 데이터는 5년간 보관된다.

**[추정]**

**QPS(Query Per Second) 추정치**

- DAU = `3억 * 50% = 1.5억`
- QPS = `1.5억 * 2 트윗 / 24시간 / 3600초 = 약 3500`
- 최대 QPS = `2 * QPS = 약 7000`
  - 왜 2를 곱하는가 : 데이터베이스에 대한 부하가 불규칙적으로 발생할 수 있기 때문. QPS에 2를 곱하는 것이 일반적으로 권장됨.

**미디어 저장을 위한 저장소 요구량**

- 평균 트윗 크기
  - tweet_id 에 64바이트
  - 텍스트에 140바이트
  - 미디어에 1MB
- 미디어 저장소 요구량 = `1.5억 * 2 * 10% + 1MB = 30TB/일`
- 5년간 미디어를 보관하기 위한 저장소 요구량: `30TB * 365 * 5 = 약 55PB`

---

## 팁

**규모 추정과 관계된 면접에서 가장 중요한 것은 문제를 풀어나가는 절차다.**

- 근사치를 활용한 계산
  - 계산 결과는 정확할 필요는 없다. 적절한 근사치를 활용하여 시간을 절약하자.
- 가정을 적어두자.
- 단위를 붙여라.